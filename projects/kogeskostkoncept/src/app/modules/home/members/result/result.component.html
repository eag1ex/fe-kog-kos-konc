<div class="card">
    <div class="form-option">
        <div class="button-area">
            <button class="btn btn-primary" (click)="addModal()">
                <i class="fad fa-plus"></i>{{ "RESULT.NEW_RESULT" | translate }}
            </button>
        </div>
    </div>
    <table class="table table-hover">
        <thead>
            <tr>
                <th
                    class="sorting"
                    [class.asc]="paging.IsSorted && paging.Field == 'result_date'"
                    [class.desc]="!paging.IsSorted && paging.Field == 'result_date'"
                    (click)="isSorting('result_date')"
                >
                    {{ "RESULT.RESULT_DATE" | translate }}
                </th>
                <th class="text-right">{{ "RESULT.WEIGHT" | translate }}</th>
                <th class="text-right">{{ "RESULT.FAT_MASS" | translate }}</th>
                <th class="text-right">{{ "RESULT.FAT" | translate }}</th>
                <th class="text-right">{{ "RESULT.MUSCLE_MASS" | translate }}</th>
                <th class="text-right">{{ "RESULT.BMI" | translate }}</th>
                <th class="text-right">{{ "RESULT.VISCERAL_FAT" | translate }}</th>
                <th class="text-right">{{ "RESULT.IN_BODY" | translate }}</th>
                <th></th>
            </tr>
        </thead>
        <tbody *ngIf="hasResult">
            <tr *ngFor="let result of memberResultDetail">
                <td data-th="date">{{ result.result_date | date : dateFormat }}</td>
                <td class="text-right" data-th="weight">{{ result.weight }}</td>
                <td class="text-right" data-th="PERCENT_FAT_MASS">{{ result.fat_mass }}</td>
                <td class="text-right" data-th="PERCENT_FAT">{{ result.fat }}</td>
                <td class="text-right" data-th="MUSCLE_MASS_IN_KG">{{ result.muscle_mass }}</td>
                <td class="text-right" data-th="BMI">{{ result.bmi }}</td>
                <td class="text-right" data-th="VISCERAL_FAT">{{ result.visceral_fat }}</td>
                <td class="text-right" data-th="INBODY_SCORE">{{ result.in_body }}</td>
                <td class="button-area">
                    <button class="btn btn-outline-primary" (click)="editModal(result); setResultId(result.id)">
                        <i class="fad fa-pencil"></i>
                    </button>
                    <button class="btn btn-outline-danger" (click)="dangerModal.show(); setResultId(result.id)">
                        <i class="fad fa-trash"></i>
                    </button>
                </td>
            </tr>
        </tbody>
    </table>
    <div class="table-no-data" *ngIf="isEmpty">
        <span [translate]="'RESULT.EMPTY_LIST'"></span>
    </div>
    <pagination
        [boundaryLinks]="true"
        [totalItems]="total"
        [itemsPerPage]="itemPerPage"
        [maxSize]="maxSize"
        [customFirstTemplate]="firstTemplate"
        [customLastTemplate]="lastTemplate"
        [customPreviousTemplate]="prevTemplate"
        [customNextTemplate]="nextTemplate"
        (pageChanged)="pageChanged($event)"
    >
    </pagination>
    <ng-template #nextTemplate let-disabled="disabled" let-currentPage="currentPage">
        <i class="fad fa-angle-right"></i>
    </ng-template>
    <ng-template #lastTemplate let-disabled="disabled" let-currentPage="currentPage">
        <i class="fad fa-angle-double-right"></i>
    </ng-template>
    <ng-template #prevTemplate let-disabled="disabled" let-currentPage="currentPage">
        <i class="fad fa-angle-left"></i>
    </ng-template>
    <ng-template #firstTemplate let-disabled="disabled" let-currentPage="currentPage">
        <i class="fad fa-angle-double-left"></i>
    </ng-template>
</div>

<!-- Add Modal -->
<form (ngSubmit)="onSubmit()" [formGroup]="resultDetailForm">
    <div
        bsModal
        #largeModal="bs-modal"
        class="modal fade"
        tabindex="-1"
        role="dialog"
        aria-labelledby="myModalLabel"
        aria-hidden="true"
    >
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title" *ngIf="!this.id">{{ "RESULT.NEW_RESULT" | translate }}</h4>
                    <h4 class="modal-title" *ngIf="this.id">{{ "RESULT.EDIT_RESULT" | translate }}</h4>
                    <button type="button" class="close" (click)="largeModal.hide()" aria-label="Close">
                        <span aria-hidden="true"><i class="fad fa-times"></i></span>
                    </button>
                </div>
                <div class="card">
                    <div class="form-group required-form">
                        <label for="result_date">{{ "RESULT.RESULT_DATE" | translate }}</label>
                        <div>
                            <input
                                type="text"
                                [ngClass]="{
                  'is-invalid':
                    f.result_date.touched &&
                    (f.result_date.errors || f.result_date.errors?.required)
                }"
                                class="form-control date-picker"
                                bsDatepicker
                                name="result_date"
                                formControlName="result_date"
                                [ngModel]="dateValueNow"
                                [bsConfig]="{
                  isAnimated: true,
                  showClearButton: false,
                  clearPosition: 'right',
                  dateInputFormat: datePickerFormat
                }"
                                value="{{
                  memberResultDetail?.result_date | date : dateFormat
                }}"
                                readonly
                            />
                            <div
                                *ngIf="
                  f.result_date.touched &&
                  (f.result_date.errors || f.result_date.errors?.required)
                "
                                class="invalid-feedback"
                            >
                                <app-control-messages [control]="resultDetailForm.get('result_date')">
                                </app-control-messages>
                            </div>
                        </div>
                    </div>
                    <div class="form-group required-form">
                        <label for="weight">{{ "RESULT.WEIGHT" | translate }}</label>
                        <div>
                            <input
                                type="text"
                                class="form-control"
                                id="weight"
                                name="weight"
                                max="999.99"
                                formControlName="weight"
                                (focus)="clearInput('weight')"
                                [ngClass]="{
                  'is-invalid':
                    f.weight.touched &&
                    (f.weight.errors || f.weight.errors?.required)
                }"
                            />
                            <div
                                *ngIf="
                  f.weight.touched &&
                  (f.weight.errors || f.weight.errors?.required)
                "
                                class="invalid-feedback"
                            >
                                <app-control-messages [control]="resultDetailForm.get('weight')">
                                </app-control-messages>
                            </div>
                        </div>
                    </div>
                    <div class="form-group required-form">
                        <label for="fat_mass">{{ "RESULT.FAT_MASS" | translate }}</label>
                        <div>
                            <input
                                type="text"
                                class="form-control"
                                id="fat_mass"
                                name="fat_mass"
                                (focus)="clearInput('fat_mass')"
                                [ngClass]="{
                  'is-invalid':
                    f.fat_mass.touched &&
                    (f.fat_mass.errors || f.fat_mass.errors?.required)
                }"
                                max="100"
                                formControlName="fat_mass"
                            />
                            <div
                                *ngIf="
                  f.fat_mass.touched &&
                  (f.fat_mass.errors || f.fat_mass.errors?.required)
                "
                                class="invalid-feedback"
                            >
                                <app-control-messages [control]="resultDetailForm.get('fat_mass')">
                                </app-control-messages>
                            </div>
                        </div>
                    </div>
                    <div class="form-group required-form">
                        <label for="fat">{{ "RESULT.FAT" | translate }}</label>
                        <div>
                            <input
                                type="text"
                                class="form-control"
                                id="fat"
                                name="fat"
                                [ngClass]="{
                  'is-invalid':
                    f.fat.touched && (f.fat.errors || f.fat.errors?.required)
                }"
                                max="100"
                                formControlName="fat"
                                (focus)="clearInput('fat')"
                            />
                            <div
                                *ngIf="
                  f.fat.touched && (f.fat.errors || f.fat.errors?.required)
                "
                                class="invalid-feedback"
                            >
                                <app-control-messages [control]="resultDetailForm.get('fat')"> </app-control-messages>
                            </div>
                        </div>
                    </div>
                    <div class="form-group required-form">
                        <label for="muscle_mass">{{ "RESULT.MUSCLE_MASS" | translate }}</label>
                        <div>
                            <input
                                type="text"
                                class="form-control"
                                id="muscle_mass"
                                name="muscle_mass"
                                [ngClass]="{
                  'is-invalid':
                    f.muscle_mass.touched &&
                    (f.muscle_mass.errors || f.muscle_mass.errors?.required)
                }"
                                max="999.99"
                                formControlName="muscle_mass"
                                (focus)="clearInput('muscle_mass')"
                            />
                            <div
                                *ngIf="
                  f.muscle_mass.touched &&
                  (f.muscle_mass.errors || f.muscle_mass.errors?.required)
                "
                                class="invalid-feedback"
                            >
                                <app-control-messages [control]="resultDetailForm.get('muscle_mass')">
                                </app-control-messages>
                            </div>
                        </div>
                    </div>
                    <div class="form-group required-form">
                        <label for="bmi">{{ "RESULT.BMI" | translate }}</label>
                        <div>
                            <input
                                type="text"
                                class="form-control"
                                id="bmi"
                                name="bmi"
                                [ngClass]="{
                  'is-invalid':
                    f.bmi.touched && (f.bmi.errors || f.bmi.errors?.required)
                }"
                                max="999"
                                (focus)="clearInput('bmi')"
                                formControlName="bmi"
                            />
                            <div
                                *ngIf="
                  f.bmi.touched && (f.bmi.errors || f.bmi.errors?.required)
                "
                                class="invalid-feedback"
                            >
                                <app-control-messages [control]="resultDetailForm.get('bmi')"> </app-control-messages>
                            </div>
                        </div>
                    </div>
                    <div class="form-group required-form">
                        <label for="visceral_fat">{{ "RESULT.VISCERAL_FAT" | translate }}</label>
                        <div>
                            <input
                                type="text"
                                class="form-control"
                                id="visceral_fat"
                                name="visceral_fat"
                                [ngClass]="{
                  'is-invalid':
                    f.visceral_fat.touched &&
                    (f.visceral_fat.errors || f.visceral_fat.errors?.required)
                }"
                                max="999"
                                (focus)="clearInput('visceral_fat')"
                                formControlName="visceral_fat"
                            />
                            <div
                                *ngIf="
                  f.visceral_fat.touched &&
                  (f.visceral_fat.errors || f.visceral_fat.errors?.required)
                "
                                class="invalid-feedback"
                            >
                                <app-control-messages [control]="resultDetailForm.get('visceral_fat')">
                                </app-control-messages>
                            </div>
                        </div>
                    </div>
                    <div class="form-group required-form">
                        <label for="in_body">{{ "RESULT.IN_BODY" | translate }}</label>
                        <div>
                            <input
                                type="text"
                                class="form-control"
                                id="in_body"
                                name="in_body"
                                [ngClass]="{
                  'is-invalid':
                    f.in_body.touched &&
                    (f.in_body.errors || f.in_body.errors?.required)
                }"
                                max="999"
                                (focus)="clearInput('in_body')"
                                formControlName="in_body"
                            />
                            <div
                                *ngIf="
                  f.in_body.touched &&
                  (f.in_body.errors || f.in_body.errors?.required)
                "
                                class="invalid-feedback"
                            >
                                <app-control-messages [control]="resultDetailForm.get('in_body')">
                                </app-control-messages>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button
                        type="button"
                        class="btn btn-secondary"
                        (click)="largeModal.hide()"
                        (click)="buildForm()"
                        (keyup.enter)="buildForm()"
                    >
                        {{ "FORM.CANCEL" | translate }}
                    </button>
                    <button type="submit" class="btn btn-primary">{{ "FORM.SAVE" | translate }}</button>
                </div>
            </div>
        </div>
    </div>
</form>

<!--Delete modal-->
<div
    bsModal
    #dangerModal="bs-modal"
    class="modal fade edit-modal"
    tabindex="-1"
    role="dialog"
    aria-labelledby="myModalLabel"
    aria-hidden="true"
>
    <div class="modal-dialog modal-dialog-centered modal-danger" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" [translate]="'DELETE_MODAL.TITLE'"></div>
            </div>
            <div class="modal-body">
                <p [translate]="'RESULT.DESCRIPTION_DELETE'"></p>
            </div>
            <div class="modal-footer">
                <button
                    type="button"
                    class="btn btn-outline-secondary"
                    (click)="dangerModal.hide()"
                    [translate]="'MODAL.CANCEL'"
                ></button>
                <button
                    type="button"
                    class="btn btn-danger"
                    (click)="deleteMemberResultById(); dangerModal.hide()"
                    [translate]="'MODAL.CONFIRM'"
                ></button>
            </div>
        </div>
    </div>
</div>
